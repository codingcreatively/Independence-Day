<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>15 August 2025 — Independence Day Celebration</title>
<meta name="description" content="Independence Day Celebration — 15 August 2025. Swipe cards, history popup, confetti and music."/>
<style>
:root{
  --bg:#071025;
  --panel:#0e1622;
  --muted:#9fb0c2;
  --glass: rgba(255,255,255,0.03);
  --saffron:#FF9933;
  --white:#ffffff;
  --green:#138808;
  --navy:#07203a;
  --accent-gradient: linear-gradient(90deg, #ffb56a 0%, #ff8f3b 60%);
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;background:linear-gradient(180deg,#041226 0%, #061027 100%);color:var(--white);-webkit-font-smoothing:antialiased}
.wrap{max-width:100%;margin:0 auto;padding:14px}

/* Top */
.top{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
.brand{display:flex;gap:10px;align-items:center}
.flag{width:60px;height:40px;border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);flex-shrink:0}
.flag svg, .flag img{width:100%;height:100%;display:block}
.title h1{font-size:1.05rem;margin:0}
.title p{font-size:0.82rem;color:var(--muted);margin-top:4px}

/* actions */
.actions{display:flex;gap:8px;align-items:center}
.btn{padding:10px 12px;border-radius:10px;border:0;font-weight:700;font-size:0.92rem;cursor:pointer;background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));color:var(--white)}
.btn.primary{background:var(--accent-gradient);color:#071225}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}

/* slider */
.slider-wrap{position:relative;margin-top:8px}
.slider{
  display:flex;
  gap:14px;
  overflow-x:auto;
  overflow-y:hidden;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
  padding:12px;
}
.slider::-webkit-scrollbar{display:none}
.card{
  flex:0 0 82%;
  max-width:82%;
  border-radius:12px;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03);
  padding:12px;
  display:flex;
  gap:10px;
  align-items:flex-start;
}
.photo{width:88px;height:88px;border-radius:10px;overflow:hidden;flex-shrink:0;border:1px solid rgba(0,0,0,0.2)}
.photo img{width:100%;height:100%;object-fit:cover;display:block}
.meta h3{margin:0;font-size:0.98rem}
.meta p{margin-top:6px;color:var(--muted);font-size:0.86rem;line-height:1.4}
.meta .role{margin-top:8px;font-size:0.8rem;color:var(--saffron);font-weight:700}
.dob{margin-top:6px;font-size:0.78rem;color:var(--muted)}

/* arrows (visible on phone as small circles) */
.arrow{
  position:absolute;top:50%;transform:translateY(-50%);
  width:36px;height:36px;border-radius:50%;
  background:rgba(0,0,0,0.35);display:flex;align-items:center;justify-content:center;
  color:white;font-size:18px;z-index:5;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.4);
}
.arrow.left{left:6px}
.arrow.right{right:6px}

/* quick list */
.list{margin-top:12px}
.list h4{font-size:1rem;margin-bottom:10px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.mini{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
.mini .img{width:54px;height:54px;border-radius:8px;overflow:hidden;flex-shrink:0}
.mini img{width:100%;height:100%;object-fit:cover}
.mini strong{display:block;font-size:0.92rem}
.mini .meta-mini{font-size:0.78rem;color:var(--muted)}

/* popup */
/* Popup backdrop - transparent edges */
.popup-backdrop {
  position: fixed;
  inset: 0;
  background: transparent; /* keep top/bottom see-through */
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9998;
}

/* Popup box - solid background */
.popup {
  background-color: #ffffff !important; /* solid dark background */
  color: #0e1622 !important;            /* readable white text */
  border-radius: 10px;
  padding: 14px;
  max-width: 94%;
  max-height: 80%;
  overflow: auto;
  display: none;
  z-index: 9999;
  border: 1px solid rgba(255,255,255,0.05);
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
}

  #historyTitle {
  margin-bottom: 20px; /* gap below the title */
}

.body h3 {
  margin-top: 25px;  /* gap above each subheading */
  margin-bottom: 10px; /* gap below each subheading */
}

.body p {
  margin-bottom: 15px; /* gap after paragraphs */
}

.body ul {
  margin-bottom: 20px; /* gap after lists */
}
  
  .top {
  display: flex;
  justify-content: center;  /* centers horizontally */
}

.brand {
  display: flex;
  flex-direction: column;    /* stack flag+title vertically */
  align-items: center;       /* center horizontally */
  text-align: center;
}

.flag {
  margin-bottom: 10px;       /* space between flag and text */
}

.actions {
  display: flex;
  justify-content: center;   /* centers buttons horizontally */
  gap: 10px;                 /* space between buttons */
  margin-top: 10px;
}
  
  
/* Show popup when active */
.popup.show { display: block !important; }
.popup-backdrop.show { display: flex !important; }
/* footer */
footer.site{margin-top:14px;text-align:center;color:var(--muted);font-size:0.9rem;padding-bottom:20px}
.contact{display:flex;gap:8px;justify-content:center;margin-top:8px}
.contact a{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;background:rgba(255,255,255,0.02);color:var(--white);text-decoration:none;font-weight:700;font-size:0.9rem}

/* small adjustments to ensure touch targets comfortable */
.btn, .mini, .card { -webkit-tap-highlight-color: rgba(255,255,255,0.05); }
</style>
</head>
<body>
  <!-- audio (will use independence.mp3 you add later) -->
  <audio id="independenceMusic" preload="none">
    <source src="independence.mp3" type="audio/mpeg">
  </audio>

  <div class="wrap" role="main" aria-labelledby="pageTitle">
    <!-- confetti canvas -->
    <canvas id="confetti" style="position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:6;"></canvas>

    <div class="top">
      <div class="brand" aria-hidden="true">
        <div class="flag" title="Indian flag" aria-hidden="true">
          <!-- inline simplified flag SVG to avoid emoji issues -->
          <svg viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Indian flag">
            <rect width="9" height="2" y="0" fill="#FF9933"/>
            <rect width="9" height="2" y="2" fill="#ffffff"/>
            <rect width="9" height="2" y="4" fill="#138808"/>
            <g transform="translate(4.5,3)"><circle r="0.35" fill="#0b3d6b"/></g>
          </svg>
        </div>
        <div class="title">
          <h1 id="pageTitle">79th Independence Day 🇮🇳</h1>
          <p class="date">Honouring courage, unity, and sacrifice</p>
        </div>
      </div>
       
    </div>
      <div class="actions" role="toolbar" aria-label="Actions">
        <button id="celebrate" class="btn primary" aria-label="Celebrate">Celebrate 🎉</button>
        <button id="historyBtn" class="btn ghost" aria-label="History">History 📖</button>
      </div>
    </div>
  
    <!-- slider -->
    <div class="slider-wrap" aria-hidden="false">
      <div class="arrow left" id="leftArrow" aria-hidden="false" title="Previous">&#10094;</div>
      <div class="arrow right" id="rightArrow" aria-hidden="false" title="Next">&#10095;</div>

      <div class="slider" id="slider" role="list" tabindex="0" aria-label="Freedom fighters slider">
        <!-- Cards: all original items included and optimized with loading=lazy -->
        <article class="card" role="listitem" aria-label="Netaji Subhas Chandra Bose">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Netaji Subhas Chandra Bose" src="https://commons.wikimedia.org/wiki/Special:FilePath/Subhas_Chandra_Bose.jpg"></div>
          <div class="meta">
            <h3>Netaji Subhas Chandra Bose</h3>
            <div class="role">Leader of the INA</div>
            <p>Organised and led the Indian National Army (INA) seeking an armed struggle for independence; inspired many with the call "Give me blood and I will give you freedom."</p>
            <div class="dob">Born: 23 Jan 1897 · Died: 18 Aug 1945</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Bhagat Singh">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Bhagat Singh" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bhagat%20Singh%201929.jpg"></div>
          <div class="meta">
            <h3>Bhagat Singh</h3>
            <div class="role">Revolutionary &amp; Martyr</div>
            <p>Young revolutionary who became a symbol of resistance against British rule; executed in 1931, inspiring generations.</p>
            <div class="dob">Born: 28 Sep 1907 · Died: 23 Mar 1931</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Rani Lakshmibai">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Rani Lakshmibai" src="https://commons.wikimedia.org/wiki/Special:FilePath/Rani%20Lakshmibai%20contemporary%20portrait.jpg"></div>
          <div class="meta">
            <h3>Rani Lakshmibai of Jhansi</h3>
            <div class="role">Warrior Queen</div>
            <p>Led forces during the 1857 uprising; celebrated for bravery and leadership.</p>
            <div class="dob">Born: 19 Nov 1828 · Died: 18 Jun 1858</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Sardar Vallabhbhai Patel">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Sardar Vallabhbhai Patel" src="https://commons.wikimedia.org/wiki/Special:FilePath/Sardar_Patel.jpg"></div>
          <div class="meta">
            <h3>Sardar Vallabhbhai Patel</h3>
            <div class="role">Iron Man of India</div>
            <p>Key organiser and later integral to unifying princely states into the Indian Union after independence.</p>
            <div class="dob">Born: 31 Oct 1875 · Died: 15 Dec 1950</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Chandrashekhar Azad">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Chandrashekhar Azad" src="https://commons.wikimedia.org/wiki/Special:FilePath/Chandrasekhar%20azad.jpg"></div>
          <div class="meta">
            <h3>Chandrashekhar Azad</h3>
            <div class="role">Revolutionary Leader</div>
            <p>Prominent revolutionary who vowed never to be captured alive; an inspirational figure for armed resistance movements.</p>
            <div class="dob">Born: 23 Jul 1906 · Died: 27 Feb 1931</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Bal Gangadhar Tilak">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Bal Gangadhar Tilak" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bal%20Gangadhar%20Tilak.jpg"></div>
          <div class="meta">
            <h3>Bal Gangadhar Tilak</h3>
            <div class="role">Mass Leader</div>
            <p>Early leader who advocated self-rule and mass mobilisation; often called "Lokmanya."</p>
            <div class="dob">Born: 23 Jul 1856 · Died: 1 Aug 1920</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Mangal Pandey">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Mangal Pandey" src="https://commons.wikimedia.org/wiki/Special:FilePath/Mangal-pandey_1460075022-1.jpg"></div>
          <div class="meta">
            <h3>Mangal Pandey</h3>
            <div class="role">Spark of 1857</div>
            <p>Soldier whose actions in 1857 are often seen as the spark of the First War of Independence.</p>
            <div class="dob">Born: 19 Jul 1827 · Died: 8 Apr 1857</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Lala Lajpat Rai">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Lala Lajpat Rai" src="https://commons.wikimedia.org/wiki/Special:FilePath/Lala%20Lajpat%20Rai%201908.jpg"></div>
          <div class="meta">
            <h3>Lala Lajpat Rai</h3>
            <div class="role">Lion of Punjab</div>
            <p>Noted leader and organiser, galvanising the movement through protests and sacrifices.</p>
            <div class="dob">Born: 28 Jan 1865 · Died: 17 Nov 1928</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Bipin Chandra Pal">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Bipin Chandra Pal" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bipin_Chandra_Pal.jpg"></div>
          <div class="meta">
            <h3>Bipin Chandra Pal</h3>
            <div class="role">Lal-Bal-Pal</div>
            <p>Part of the trio advocating Swadeshi and national self-reliance; promoted active resistance against colonial economic control.</p>
            <div class="dob">Born: 7 Nov 1858 · Died: 20 May 1932</div>
          </div>
        </article>

        <article class="card" role="listitem" aria-label="Sarojini Naidu">
          <div class="photo"><img loading="lazy" width="540" height="540" alt="Sarojini Naidu" src="https://commons.wikimedia.org/wiki/Special:FilePath/Sarojini_Naidu.jpg"></div>
          <div class="meta">
            <h3>Sarojini Naidu</h3>
            <div class="role">Nightingale of India</div>
            <p>Poet and leader who energised the freedom movement and later became an influential political leader.</p>
            <div class="dob">Born: 13 Feb 1879 · Died: 2 Mar 1949</div>
          </div>
        </article>

      </div> <!-- /slider -->
    </div> <!-- /slider-wrap -->

    <!-- Quick list (stacked under slider for mobile) -->
    <aside class="list" aria-labelledby="heroesTitle">
      <h4 id="heroesTitle">Freedom Fighters (quick list)</h4>
      <div class="grid" id="miniGrid">
        <div class="mini" data-idx="0"><div class="img"><img loading="lazy" width="240" height="240" alt="Netaji" src="https://commons.wikimedia.org/wiki/Special:FilePath/Subhas_Chandra_Bose.jpg"></div><div><strong>Netaji</strong><div class="meta-mini">23 Jan 1897 · 18 Aug 1945</div></div></div>

        <div class="mini" data-idx="1"><div class="img"><img loading="lazy" width="240" height="240" alt="Bhagat Singh" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bhagat%20Singh%201929.jpg"></div><div><strong>Bhagat Singh</strong><div class="meta-mini">28 Sep 1907 · 23 Mar 1931</div></div></div>

        <div class="mini" data-idx="2"><div class="img"><img loading="lazy" width="240" height="240" alt="Rani" src="https://commons.wikimedia.org/wiki/Special:FilePath/Rani%20Lakshmibai%20contemporary%20portrait.jpg"></div><div><strong>Rani Lakshmibai</strong><div class="meta-mini">19 Nov 1828 · 18 Jun 1858</div></div></div>

        <div class="mini" data-idx="3"><div class="img"><img loading="lazy" width="240" height="240" alt="Patel" src="https://commons.wikimedia.org/wiki/Special:FilePath/Sardar_Patel.jpg"></div><div><strong>Sardar Patel</strong><div class="meta-mini">31 Oct 1875 · 15 Dec 1950</div></div></div>

        <div class="mini" data-idx="4"><div class="img"><img loading="lazy" width="240" height="240" alt="Azad" src="https://commons.wikimedia.org/wiki/Special:FilePath/Chandrasekhar%20azad.jpg"></div><div><strong>Chandrashekhar Azad</strong><div class="meta-mini">23 Jul 1906 · 27 Feb 1931</div></div></div>

        <div class="mini" data-idx="5"><div class="img"><img loading="lazy" width="240" height="240" alt="Tilak" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bal%20Gangadhar%20Tilak.jpg"></div><div><strong>Bal Gangadhar Tilak</strong><div class="meta-mini">23 Jul 1856 · 1 Aug 1920</div></div></div>

        <div class="mini" data-idx="6"><div class="img"><img loading="lazy" width="240" height="240" alt="Mangal Pandey" src="https://commons.wikimedia.org/wiki/Special:FilePath/Mangal-pandey_1460075022-1.jpg"></div><div><strong>Mangal Pandey</strong><div class="meta-mini">19 Jul 1827 · 8 Apr 1857</div></div></div>

        <div class="mini" data-idx="7"><div class="img"><img loading="lazy" width="240" height="240" alt="Lajpat Rai" src="https://commons.wikimedia.org/wiki/Special:FilePath/Lala%20Lajpat%20Rai%201908.jpg"></div><div><strong>Lala Lajpat Rai</strong><div class="meta-mini">28 Jan 1865 · 17 Nov 1928</div></div></div>

        <div class="mini" data-idx="8"><div class="img"><img loading="lazy" width="240" height="240" alt="Bipin Chandra Pal" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bipin_Chandra_Pal.jpg"></div><div><strong>Bipin Chandra Pal</strong><div class="meta-mini">7 Nov 1858 · 20 May 1932</div></div></div>

        <div class="mini" data-idx="9"><div class="img"><img loading="lazy" width="240" height="240" alt="Sarojini Naidu" src="https://commons.wikimedia.org/wiki/Special:FilePath/Sarojini_Naidu.jpg"></div><div><strong>Sarojini Naidu</strong><div class="meta-mini">13 Feb 1879 · 2 Mar 1949</div></div></div>

      </div>

      <footer style="margin-top:12px;text-align:center;color:var(--muted)">
        <div><strong>Jai Hind 🇮🇳</strong></div>
        <div style="margin-top:6px">15 August 2025 · Remember the sacrifice</div>
      </footer>
    </aside>
  </div>

  <!-- history popup -->
  <div class="popup-backdrop" id="popupBackdrop" aria-hidden="true">
    <div class="popup" id="historyPopup" role="dialog" aria-modal="true" aria-labelledby="historyTitle" aria-hidden="true">
 <h2 id="historyTitle">Indian Independence &amp; Flag History 📖</h2>
    <div class="body">
      <h3>Indian Independence — A short history</h3>
      <p>India's path to independence spans more than a century of political struggle, civil disobedience, intellectual debate, cultural revival, and revolutionary action. Key moments include:</p>
      <ul>
        <li><strong>1857:</strong> The First War of Independence (also known as the 1857 uprising) saw widespread revolt against the East India Company, with leaders like Rani Lakshmibai and Mangal Pandey emerging as symbols of resistance.</li>
        <li><strong>Late 19th century — Early 20th century:</strong> Political organisation and social reform movements grew across the subcontinent. Leaders such as Bal Gangadhar Tilak, Bipin Chandra Pal, and others promoted swadeshi and national awareness.</li>
        <li><strong>1915–1922:</strong> Mahatma Gandhi returned to India (1915) and led movements based on non-violent civil disobedience, including the Non-Cooperation Movement.</li>
        <li><strong>1930s:</strong> The Salt March (Dandi March) and the Civil Disobedience Movement expanded mass participation in the freedom struggle.</li>
        <li><strong>1942:</strong> The Quit India Movement called for immediate British withdrawal, leading to mass arrests and intensified demands for independence.</li>
        <li><strong>1946–1947:</strong> A combination of political negotiations, public pressure, post-war realities, and partition debates culminated in the British agreeing to transfer power. India achieved independence on <strong>15 August 1947</strong>.</li>
      </ul>

      <h3>Why we remember</h3>
      <p>The freedom movement was not the work of a single person or party — it included moderate politicians, revolutionary groups, women leaders, labour movements, peasants, students, writers and countless unnamed people. Together they shaped the idea of a free India.</p>

      <h3>History of the Indian National Flag</h3>
      <p>The Indian flag also evolved over decades. Early 20th-century designs experimented with colours, symbols and formats as patriots sought an emblem representing national aspirations.</p>
      <p><strong>Key milestones:</strong></p>
      <ul>
        <li>Early designs (1906–1921) used combinations of saffron, green, and symbols such as the charkha (spinning wheel) to represent unity and self-reliance.</li>
        <li>In 1921, Pingali Venkayya proposed a flag with a spinning wheel at the center. The charkha (spinning wheel) became a symbol of the independence struggle.</li>
        <li>On <strong>22 July 1947</strong>, a form of the tricolor (with saffron, white, and green and the Ashoka Chakra in place of the charkha) was accepted as the provisional national flag.</li>
        <li>The flag represents: <em>saffron</em> for courage and sacrifice, <em>white</em> for peace and truth, <em>green</em> for faith and fertility, and the <em>Ashoka Chakra</em> for law and dharma (righteousness).</li>
      </ul>
       
 
      
      <p class="hint">Click anywhere on this popup backdrop or press <kbd>Esc</kbd> to close.</p>
    </div>
  </div>
  </div>

  <!-- footer -->
  <footer class="site" role="contentinfo">
    <div style="text-align:center;color:var(--muted)">This website made by Sujoy ❤️</div>
    <div class="contact" style="margin-top:8px">
      <a id="fbBtn" href="https://www.facebook.com/share/19mTtJtPgs/" target="_blank" rel="noopener noreferrer">Facebook 👤</a>
      <a id="igBtn" href="https://www.instagram.com/coding_creatively?igsh=MWs4bGNnZ3R0dmhneg==" target="_blank" rel="noopener noreferrer">Instagram 🎥</a>
      <a id="waBtn" href="https://wa.me/9800060565" target="_blank" rel="noopener noreferrer">WhatsApp 📱</a>
    </div>
  </footer>

<script>
/* HISTORY POPUP - fixed for touch */
const historyBtn = document.getElementById('historyBtn');
const popup = document.getElementById('historyPopup');
const backdrop = document.getElementById('popupBackdrop');

function showPopup(){
  if(!popup || !backdrop) return;
  popup.classList.add('show');
  backdrop.classList.add('show');
  popup.setAttribute('aria-hidden','false');
  backdrop.setAttribute('aria-hidden','false');
}
function hidePopup(){
  if(!popup || !backdrop) return;
  popup.classList.remove('show');
  backdrop.classList.remove('show');
  popup.setAttribute('aria-hidden','true');
  backdrop.setAttribute('aria-hidden','true');
}
historyBtn?.addEventListener('click', showPopup);
backdrop?.addEventListener('click', hidePopup);
document.addEventListener('keydown', e => { if(e.key === 'Escape') hidePopup(); });
// stop clicks inside content from closing the popup
popup?.querySelector('.body')?.addEventListener('click', e => e.stopPropagation());


/* SLIDER - fixed: arrows handlers attached outside function, precise card width calc */
const slider = document.getElementById('slider');
const left = document.getElementById('leftArrow');
const right = document.getElementById('rightArrow');

function cardWidthPlusGap(){
  const c = slider?.querySelector('.card');
  if(!c) return 0;
  const gap = parseInt(getComputedStyle(slider).gap || 14, 10);
  return c.offsetWidth + gap;
}

function scrollByCard(dir = 1){
  const w = cardWidthPlusGap();
  if(!w || !slider) return;
  slider.scrollBy({ left: Math.round(w * dir), behavior: 'smooth' });
}

left?.addEventListener('click', ()=> scrollByCard(-1));
right?.addEventListener('click', ()=> scrollByCard(1));

/* mini grid click -> scroll to card */
document.getElementById('miniGrid')?.addEventListener('click', (e) => {
  const mini = e.target.closest('.mini');
  if(!mini || !slider) return;
  const idx = parseInt(mini.getAttribute('data-idx') || '0', 10);
  const cards = document.querySelectorAll('.card');
  if(cards[idx]){
    const leftPos = cards[idx].offsetLeft - slider.offsetLeft;
    slider.scrollTo({ left: leftPos, behavior: 'smooth' });
  }
});

/* Prevent whole page vertical scroll while horizontally swiping slider */
slider?.addEventListener('wheel', (e) => {
  if(Math.abs(e.deltaX) > Math.abs(e.deltaY)) {
    e.preventDefault();
    slider.scrollLeft += e.deltaX;
  }
},{passive:false});

/* One-time message when reach last card */
const oneTimeKey = 'independence_slider_viewed_v1';
function checkLastCardSeen(){
  if(localStorage.getItem(oneTimeKey)) return;
  const cards = document.querySelectorAll('.card');
  if(cards.length === 0 || !slider) return;
  function onScroll(){
    const maxScrollLeft = slider.scrollWidth - slider.clientWidth;
    if(slider.scrollLeft >= maxScrollLeft - 2){
      showTempMessage('Thank you for remembering this special day 🎉');
      localStorage.setItem(oneTimeKey, 'true');
      slider.removeEventListener('scroll', onScroll);
    }
  }
  slider.addEventListener('scroll', onScroll);
}
function showTempMessage(text){
  const el = document.createElement('div');
  el.style.position = 'fixed';
  el.style.bottom = '18px';
  el.style.left = '50%';
  el.style.transform = 'translateX(-50%)';
  el.style.background = 'rgba(22,22,22,0.94)';
  el.style.color = 'white';
  el.style.padding = '10px 14px';
  el.style.borderRadius = '20px';
  el.style.zIndex = '10000';
  el.style.boxShadow = '0 6px 20px rgba(0,0,0,0.6)';
  el.innerHTML = text;
  document.body.appendChild(el);
  setTimeout(()=> el.remove(), 4000);
}
checkLastCardSeen();

/* CONFETTI + MUSIC (lightweight) */
const canvas = document.getElementById('confetti');
const ctx = canvas?.getContext ? canvas.getContext('2d') : null;
let particles = [];
const colors = ['#FF9933','#FFFFFF','#138808','#0b3d6b','#FFD54A'];

function fitCanvas(){
  if(!canvas) return;
  canvas.width = canvas.offsetWidth;
  canvas.height = canvas.offsetHeight;
}
window.addEventListener('resize', fitCanvas);
fitCanvas();

function spawn(x,y,count=60){
  for(let i=0;i<count;i++){
    particles.push({
      x: x + (Math.random()*80 - 40),
      y: y + (Math.random()*40 - 20),
      vx: (Math.random()*6-3),
      vy: (Math.random()*6 + 1),
      sz: Math.random()*8 + 6,
      rot: Math.random()*360,
      vr: (Math.random()*8-4),
      col: colors[Math.floor(Math.random()*colors.length)],
      life: 0,
      ttl: 120 + Math.random()*80
    });
  }
}
function update(){
  if(!ctx || !canvas) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i = particles.length-1; i>=0; i--){
    const p = particles[i];
    p.vy += 0.08; p.x += p.vx; p.y += p.vy; p.rot += p.vr*0.02; p.life++;
    ctx.save();
    ctx.translate(p.x,p.y); ctx.rotate(p.rot * Math.PI/180);
    ctx.fillStyle = p.col;
    ctx.fillRect(-p.sz/2, -p.sz/2, p.sz, p.sz*0.6);
    ctx.restore();
    if(p.y > canvas.height + 50 || p.life > p.ttl) particles.splice(i,1);
  }
  requestAnimationFrame(update);
}
requestAnimationFrame(update);

const music = document.getElementById('independenceMusic');
let musicStarted = false;

document.getElementById('celebrate')?.addEventListener('click', ()=>{
  if(!canvas) return;
  for(let i=0;i<4;i++){
    spawn(Math.random()*canvas.width, -10, 40 + Math.random()*40);
  }
  try {
    if(music){
      music.volume = 0.6;
      music.play().then(()=> { musicStarted = true; }).catch(err => {
        console.warn('Music play blocked or missing file:', err);
      });
    }
  } catch(e){ console.warn(e); }
});

// try play once on first user click to allow audio
document.body.addEventListener('click', function startOnce(){
  if(!musicStarted && music){
    music.play().then(()=> { musicStarted = true; }).catch(()=>{});
  }
  document.body.removeEventListener('click', startOnce);
}, {once:true});

/* Image fallback for broken images */
document.querySelectorAll('.photo img, .mini img').forEach(img=>{
  img.onerror = function(){
    this.onerror = null;
    this.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="200"><rect width="100%" height="100%" fill="%230e1622"/><text x="50%" y="50%" fill="%239fb0c2" font-size="14" text-anchor="middle" dominant-baseline="middle">Image not available</text></svg>';
  };
});
</script>
</body>
</html>